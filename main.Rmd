---
title: "ST558- Project 3"
author: "Rohan Prabhune, Manan Shah"
output: 
  github_document:
    toc: true
    toc_depth: 2
always_allow_html: true
---
```{r Temp1,echo=FALSE,eval=TRUE,message=FALSE,warning=FALSE}
knitr::opts_chunk$set(fig.align = 'center',echo=TRUE,eval=TRUE,message=FALSE,warning=FALSE) 
```

# Loading the necessary packages
```{r packages}
library(tidyverse)
library(caret)
```

# Reading the data:
*Citation for the dataset:  
K. Fernandes, P. Vinagre and P. Cortez. A Proactive Intelligent Decision
Support System for Predicting the Popularity of Online News. Proceedings
of the 17th EPIA 2015 - Portuguese Conference on Artificial Intelligence,
September, Coimbra, Portugal.*

```{r Data}
#Reading the data
dataset <- read_csv("data/OnlineNewsPopularity.csv",show_col_types=FALSE) 
dataset
```

# Pre-processing:  

## Subset data based on type of article
```{r preprocessing}
# Vector of columns other than data_channel_is*
remaining_cols = c(names(dataset))[c(1:13,20:61)]
remaining_cols
# Subset based on type of article
input_data_channel = "entertainment"
select_var = paste0("data_channel_is_",input_data_channel)
subset_cols = append(remaining_cols,select_var)
# Subset data
df <- dataset %>% select(all_of(subset_cols)) %>%
  filter(dataset[select_var] == 1) %>%
  select(all_of(remaining_cols))
df
```

## Variable selection
```{r preprocessing2}
#Remove url and timedelta
# Remove "weekday_is_saturday" and "weekday_is_sunday" to only keep "is_weekend"
df <- df %>% select(-url,-timedelta,-weekday_is_saturday,-weekday_is_sunday)
df
```
## Spliting the data into train and test set
```{r}
train_size <- sample(nrow(df), nrow(df)*0.7)
train_df <- df[train_size,]
test_df <- df[-train_size,] 
```

## Summarization
```{r}
summary(train_df$num_imgs)
summary(train_df$n_unique_tokens)
summary(train_df$num_videos)
summary(train_df$num_keywords)

train_df$weekday <- if_else(train_df$weekday_is_monday == 1, "Mon", if_else(train_df$weekday_is_tuesday == 1, "Tues", if_else(train_df$weekday_is_wednesday == 1, "Wed", if_else(train_df$weekday_is_thursday == 1, "Thurs", if_else(train_df$weekday_is_friday == 1, "Fri", "NA")))))

train_df$image_grouped <- if_else(train_df$num_imgs %in% c(1:25), "1-25", if_else(train_df$num_imgs %in% c(26:50), "26-50", if_else(train_df$num_imgs %in% c(51:75), "51-75", if_else(train_df$num_imgs %in% c(76:101), "76-100","NA"))))

contingency_1 <- table(as.factor(train_df$weekday), as.factor(train_df$image_grouped))
contingency_1

contingency_2 <- table(as.factor(train_df$weekday), as.factor(train_df$num_keywords))
contingency_2

data_plot_1 <- train_df %>% select(weekday, shares) %>% group_by(weekday) %>% summarise(Num_Of_Shares = sum(shares))
plot_1 <- ggplot(data = data_plot_1, aes(weekday, Num_Of_Shares)) + labs(x = "Days of Week", y = "Number OF Shares") + geom_bar(fill = "steelblue", stat = "identity")
plot_1

data_plot_2 <- train_df %>% select(shares, num_keywords)
data_plot_2
plot_2 <- ggplot(data_plot_2, aes(num_keywords, shares)) + geom_point() + geom_jitter(aes(col = shares))
plot_2

data_plot_3 <- train_df %>% select(n_tokens_title, shares) %>% group_by(n_tokens_title) %>% summarise(mean_token_title = mean(shares))
data_plot_3
plot_3 <- ggplot(data_plot_3, aes(n_tokens_title, mean_token_title)) + geom_line()
plot_3
```

```{r}
#This is a comment
```

